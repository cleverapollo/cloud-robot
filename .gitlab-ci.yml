stages:
    - lint
    - deploy

lint:
    image: gitlab.cloudcix.com:5005/utils/ci/lint
    stage: lint
    script:
        - flake8

deploy_staging:
    image: gitlab.cloudcix.com:5005/cloudcix/deployment/image
    before_script:
        - cp ~/.ssh/application_framework/stage_key ~/.ssh/id_rsa
        - cp ~/.ssh/application_framework/stage_key.pub ~/.ssh/id_rsa.pub
    environment: staging
    stage: deploy
    script:
        - ansible-playbook -i deployment/hosts deployment/playbook.yml
    only: ["master"]
