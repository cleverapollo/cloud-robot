stages:
    - lint
    - deploy

lint:
    image: python:latest
    stage: lint
    before_script:
        - pip3 install flake8
    script: 
        - flake8 --exclude fabfile.py --ignore E402

deploy_staging:
    image: gitlab.cloudcix.com:5005/cloudcix/deployment/image
    before_script:
        - cp ~/.ssh/application_framework/stage_key ~/.ssh/id_rsa
        - cp ~/.ssh/application_framework/stage_key.pub ~/.ssh/id_rsa.pub
    environment: staging
    stage: deploy
    script:
        - fab staging deploy
    only: ["master"]
